!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.PhotoSwipeUI_Default=t()}(this,function(){"use strict";return function(i,s){function t(e){var t=(e=e||i.scrollWrap.querySelector(".pswp__button--caption--ctrl")).parentNode,o=t.querySelector(".pswp__caption__center"),n=R(t);e.classList.contains("pswp__button--caption--ctrl--expand")?(console.log("expand caption"),t.clientHeight<n.captionMaxHeight?(t.style.top=window.innerHeight-t.clientHeight+"px",o.style.height="auto"):(t.style.top=n.gapTop+"px",o.style.height=n.captionMaxHeight+"px",o.style.overflowY="auto",o.focus(),console.log("innerCaptionElement should be focussed")),e.classList.remove("pswp__button--caption--ctrl--expand"),e.classList.add("pswp__button--caption--ctrl--collapse"),e.setAttribute("title","Collapse caption"),o.setAttribute("aria-expanded","true")):(console.log("collapse caption"),o.style.height="auto",o.setAttribute("aria-expanded","false"),t.style.top=n.captionInitialPositionTop+"px",e.classList.add("pswp__button--caption--ctrl--expand"),e.classList.remove("pswp__button--caption--ctrl--collapse"),e.setAttribute("title","Expand caption"))}function e(e){if(y)return!0;e=e||window.event,L.timeToIdle&&L.mouseUsed&&!C&&N();for(var t,o,n=e.target||e.srcElement,i=n.getAttribute("class")||"",r=0;r<U.length;r++)(t=U[r]).onTap&&-1<i.indexOf("pswp__"+t.name)&&(t.onTap(n),o=!0);if(n.closest(".pswp__caption__center")&&(o=!0),o){e.stopPropagation&&e.stopPropagation(),y=!0;var a=s.features.isOldAndroid?600:30;setTimeout(function(){y=!1},a)}}function o(e,t,o){s[(o?"add":"remove")+"Class"](e,"pswp__"+t)}function n(){var e=1===L.getNumItemsFn();e!==S&&(o(w,"ui--one-slide",e),S=e)}function r(){o(b,"share-modal--hidden",K)}function a(){return(K=!K)?(s.removeClass(b,"pswp__share-modal--fade-in"),setTimeout(function(){K&&r()},300)):(r(),setTimeout(function(){K||s.addClass(b,"pswp__share-modal--fade-in")},30)),K||D(),0}function l(e){var t=(e=e||window.event).target||e.srcElement;return i.shout("shareLinkClick",e,t),!!t.href&&(!!t.hasAttribute("download")||(window.open(t.href,"pswp_share","scrollbars=yes,resizable=yes,toolbar=no,location=yes,width=550,height=420,top=100,left="+(window.screen?Math.round(screen.width/2-275):100)),K||a(),!1))}function p(e){for(var t=0;t<L.closeElClasses.length;t++)if(s.hasClass(e,"pswp__"+L.closeElClasses[t]))return!0}function c(e){var t=(e=e||window.event).relatedTarget||e.toElement;t&&"HTML"!==t.nodeName||(clearTimeout(A),A=setTimeout(function(){O.setIdle(!0)},L.timeToIdleOutside))}function u(e){var t=e.vGap;if(!i.likelyTouchDevice||L.mouseUsed||screen.width>L.fitControlsWidth||L.allowLongCaptions){var o=L.barsSize;if(L.showCaption&&"auto"===o.bottom)if(f||((f=s.createElement("pswp__caption pswp__caption--fake")).appendChild(s.createElement("pswp__caption__center")),w.insertBefore(f,h),s.addClass(w,"pswp__ui--fit")),L.addCaptionHTMLFn(e,f)){var n=f.clientHeight;t.bottom=parseInt(n,10)||44}else t.bottom=o.top;else t.bottom="auto"===o.bottom?0:o.bottom;t.top=o.top}else t.top=t.bottom=0}function d(){function e(e){if(e)for(var t=e.length,o=0;o<t;o++){i=e[o],r=i.className;for(var n=0;n<U.length;n++)a=U[n],-1<r.indexOf("pswp__"+a.name)&&(L[a.option]?(s.removeClass(i,"pswp__element--disabled"),a.onInit&&a.onInit(i)):s.addClass(i,"pswp__element--disabled"))}}var i,r,a;e(w.children);var t=s.getChildByClass(w,"pswp__top-bar");t&&e(t.children),function(){var e=document.querySelector(".pswp__caption");if(!e.querySelector(".pswp__button--caption--ctrl")){var t=document.createElement("button"),o=e.querySelector(".pswp__caption__center");t.setAttribute("class","pswp__button pswp__button--caption--ctrl"),t.setAttribute("title","Expand caption"),e.insertBefore(t,o)}}()}var m,w,h,f,_,g,b,v,C,T,I,x,F,S,L,y,E,A,O=this,k=!1,H=!0,K=!0,P={barsSize:{top:44,bottom:"auto"},closeElClasses:["item","caption","zoom-wrap","ui","top-bar"],timeToIdle:4e3,timeToIdleOutside:1e3,loadingIndicatorDelay:1e3,addCaptionHTMLFn:function(e,t){var o=t.querySelector(".pswp__caption__center");if(!e.title)return o.innerHTML="",!1;if(o.innerHTML=e.title,L.allowLongCaptions){var n=e.initialPosition.y,i=Math.round(e.h*e.initialZoomLevel),r=e.vGap.top;M(t,n,i,r);var a=R(t);t.style.bottom="auto",t.style.top=a.captionInitialPositionTop+"px",o.style.height="auto";var s=t.querySelector(".pswp__button--caption--ctrl");o.clientHeight-10>a.captionInitialHeight?(s.classList.add("pswp__button--caption--ctrl--expand"),s.setAttribute("aria-controls","pswp__caption__center"),o.setAttribute("aria-expanded","false")):q(s)}return!0},showCloseCtrl:!0,showFullscreenCtrl:!0,showZoomCtrl:!0,showShareCtrl:!0,showCounter:!0,showNextPreviousArrows:!0,showCaption:!0,allowLongCaptions:!1,preloaderEl:!0,tapToClose:!1,tapToToggleControls:!0,clickToCloseNonZoomable:!0,shareButtons:[{id:"facebook",label:"Share on Facebook",url:"https://www.facebook.com/sharer/sharer.php?u={{url}}"},{id:"twitter",label:"Tweet",url:"https://twitter.com/intent/tweet?text={{text}}&url={{url}}"},{id:"pinterest",label:"Pin it",url:"http://www.pinterest.com/pin/create/button/?url={{url}}&media={{image_url}}&description={{text}}"},{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}],getImageURLForShare:function(){return i.currItem.src||""},getPageURLForShare:function(){return window.location.href},getTextForShare:function(){return i.currItem.title||""},indexIndicatorSep:" / ",fitControlsWidth:1200},M=function(e,t,o,n){e.dataset.imagePositionTop=t,e.dataset.apparentImageHeight=o,e.dataset.gapTop=n},R=function(e){var t={};return t.gapTop=parseInt(e.dataset.gapTop,10),t.imagePositionTop=parseInt(e.dataset.imagePositionTop,10),t.apparentImageHeight=parseInt(e.dataset.apparentImageHeight,10),t.captionInitialPositionTop=t.imagePositionTop+t.apparentImageHeight,t.captionInitialHeight=window.innerHeight-t.captionInitialPositionTop,t.captionMaxHeight=window.innerHeight-t.gapTop,t},q=function(e){(e=e||i.scrollWrap.querySelector(".pswp__button--caption--ctrl")).classList.remove("pswp__button--caption--ctrl--expand"),e.classList.remove("pswp__button--caption--ctrl--collapse"),e.removeAttribute("aria-controls"),e.parentNode.querySelector(".pswp__caption__center").removeAttribute("aria-expanded")},D=function(){for(var e,t,o,n,i="",r=0;r<L.shareButtons.length;r++)e=L.shareButtons[r],t=L.getImageURLForShare(e),o=L.getPageURLForShare(e),n=L.getTextForShare(e),i+='<a href="'+e.url.replace("{{url}}",encodeURIComponent(o)).replace("{{image_url}}",encodeURIComponent(t)).replace("{{raw_image_url}}",t).replace("{{text}}",encodeURIComponent(n))+'" target="_blank" class="pswp__share--'+e.id+'"'+(e.download?"download":"")+">"+e.label+"</a>",L.parseShareButtonOut&&(i=L.parseShareButtonOut(e,i));b.children[0].innerHTML=i,b.children[0].onclick=l},z=0,N=function(){clearTimeout(A),z=0,C&&O.setIdle(!1)},Z=function(e){x!==e&&(o(I,"preloader--active",!e),x=e)},U=[{name:"caption",option:"showCaption",onInit:function(e){h=e}},{name:"share-modal",option:"showShareCtrl",onInit:function(e){b=e},onTap:function(){a()}},{name:"button--share",option:"showShareCtrl",onInit:function(e){g=e},onTap:function(){a()}},{name:"button--zoom",option:"showZoomCtrl",onTap:i.toggleDesktopZoom},{name:"counter",option:"showCounter",onInit:function(e){_=e}},{name:"button--close",option:"showCloseCtrl",onTap:i.close},{name:"button--arrow--left",option:"showNextPreviousArrows",onTap:i.prev},{name:"button--arrow--right",option:"showNextPreviousArrows",onTap:i.next},{name:"button--fs",option:"showFullscreenCtrl",onTap:function(){m.isFullscreen()?m.exit():m.enter()}},{name:"button--caption--ctrl",option:"allowLongCaptions",onTap:function(e){t(e)}},{name:"preloader",option:"preloaderEl",onInit:function(e){I=e}}];O.init=function(){var t;s.extend(i.options,P,!0),L=i.options,w=s.getChildByClass(i.scrollWrap,"pswp__ui"),T=i.listen,L.closeOnScroll&&(console.info("Resetting _options.closeOnScroll to false because _options.allowLongCaptions is true."),L.closeOnScroll=!1),L.closeOnVerticalDrag&&(console.info("Resetting _options.closeOnVerticalDrag to false because _options.allowLongCaptions is true."),L.closeOnVerticalDrag=!1),T("onVerticalDrag",function(e){H&&e<.95?O.hideControls():!H&&.95<=e&&O.showControls()}),T("onPinchClose",function(e){H&&e<.9?(O.hideControls(),t=!0):t&&!H&&.9<e&&O.showControls()}),T("zoomGestureEnded",function(){(t=!1)&&!H&&O.showControls()}),T("beforeChange",O.update),T("doubleTap",function(e){var t=i.currItem.initialZoomLevel;i.getZoomLevel()!==t?i.zoomTo(t,e,333):i.zoomTo(L.getDoubleTapZoom(!1,i.currItem),e,333)}),T("preventDragEvent",function(e,t,o){var n=e.target||e.srcElement;n&&n.getAttribute("class")&&-1<e.type.indexOf("mouse")&&(0<n.getAttribute("class").indexOf("__caption")||/(SMALL|STRONG|EM)/i.test(n.tagName))&&(o.prevent=!1)}),T("bindEvents",function(){s.bind(w,"pswpTap click",e),s.bind(i.scrollWrap,"pswpTap",O.onGlobalTap),i.likelyTouchDevice||s.bind(i.scrollWrap,"mouseover",O.onMouseOver)}),T("unbindEvents",function(){K||a(),E&&clearInterval(E),s.unbind(document,"mouseout",c),s.unbind(document,"mousemove",N),s.unbind(w,"pswpTap click",e),s.unbind(i.scrollWrap,"pswpTap",O.onGlobalTap),s.unbind(i.scrollWrap,"mouseover",O.onMouseOver),m&&(s.unbind(document,m.eventK,O.updateFullscreen),m.isFullscreen()&&(L.hideAnimationDuration=0,m.exit()),m=null)}),T("destroy",function(){L.showCaption&&(f&&w.removeChild(f),s.removeClass(h,"pswp__caption--empty")),b&&(b.children[0].onclick=null),s.removeClass(w,"pswp__ui--over-close"),s.addClass(w,"pswp__ui--hidden"),O.setIdle(!1)}),L.showAnimationDuration||s.removeClass(w,"pswp__ui--hidden"),T("initialZoomIn",function(){L.showAnimationDuration&&s.removeClass(w,"pswp__ui--hidden")}),T("initialZoomOut",function(){s.addClass(w,"pswp__ui--hidden")}),T("parseVerticalMargin",u),d(),L.shareEl&&g&&b&&(K=!0),n(),L.timeToIdle&&T("mouseUsed",function(){s.bind(document,"mousemove",N),s.bind(document,"mouseout",c),E=setInterval(function(){2===++z&&O.setIdle(!0)},L.timeToIdle/2)}),L.fullscreenEl&&!s.features.isOldAndroid&&((m=m||O.getFullscreenAPI())?(s.bind(document,m.eventK,O.updateFullscreen),O.updateFullscreen(),s.addClass(i.template,"pswp--supports-fs")):s.removeClass(i.template,"pswp--supports-fs")),L.preloaderEl&&(Z(!0),T("beforeChange",function(){clearTimeout(F),F=setTimeout(function(){i.currItem&&i.currItem.loading?i.allowProgressiveImg()&&(!i.currItem.img||i.currItem.img.naturalWidth)||Z(!1):Z(!0)},L.loadingIndicatorDelay)}),T("imageLoadComplete",function(e,t){i.currItem===t&&Z(!0)}))},O.setIdle=function(e){o(w,"ui--idle",C=e)},O.update=function(){k=!(!H||!i.currItem)&&(O.updateIndexIndicator(),L.showCaption&&(L.addCaptionHTMLFn(i.currItem,h),o(h,"caption--empty",!i.currItem.title)),!0),K||a(),n()},O.updateFullscreen=function(e){e&&setTimeout(function(){i.setScrollOffset(0,s.getScrollY())},50),s[(m.isFullscreen()?"add":"remove")+"Class"](i.template,"pswp--fs")},O.updateIndexIndicator=function(){L.showCounter&&(_.innerHTML=i.getCurrentIndex()+1+L.indexIndicatorSep+L.getNumItemsFn())},O.onGlobalTap=function(e){var t=(e=e||window.event).target||e.srcElement;if(!y)if(e.detail&&"mouse"===e.detail.pointerType){if(p(t))return void i.close();s.hasClass(t,"pswp__img")&&(1===i.getZoomLevel()&&i.getZoomLevel()<=i.currItem.fitRatio?L.clickToCloseNonZoomable&&i.close():i.toggleDesktopZoom(e.detail.releasePoint))}else if(L.tapToToggleControls&&(H?O.hideControls():O.showControls()),L.tapToClose&&(s.hasClass(t,"pswp__img")||p(t)))return void i.close()},O.onMouseOver=function(e){var t=(e=e||window.event).target||e.srcElement;o(w,"ui--over-close",p(t))},O.hideControls=function(){s.addClass(w,"pswp__ui--hidden"),H=!1},O.showControls=function(){H=!0,k||O.update(),s.removeClass(w,"pswp__ui--hidden")},O.supportsFullscreen=function(){var e=document;return!!(e.exitFullscreen||e.mozCancelFullScreen||e.webkitExitFullscreen||e.msExitFullscreen)},O.getFullscreenAPI=function(){var e,t=document.documentElement,o="fullscreenchange";return t.requestFullscreen?e={enterK:"requestFullscreen",exitK:"exitFullscreen",elementK:"fullscreenElement",eventK:o}:t.mozRequestFullScreen?e={enterK:"mozRequestFullScreen",exitK:"mozCancelFullScreen",elementK:"mozFullScreenElement",eventK:"moz"+o}:t.webkitRequestFullscreen?e={enterK:"webkitRequestFullscreen",exitK:"webkitExitFullscreen",elementK:"webkitFullscreenElement",eventK:"webkit"+o}:t.msRequestFullscreen&&(e={enterK:"msRequestFullscreen",exitK:"msExitFullscreen",elementK:"msFullscreenElement",eventK:"MSFullscreenChange"}),e&&(e.enter=function(){if(v=L.closeOnScroll,L.closeOnScroll=!1,"webkitRequestFullscreen"!==this.enterK)return i.template[this.enterK]();i.template[this.enterK](Element.ALLOW_KEYBOARD_INPUT)},e.exit=function(){return L.closeOnScroll=v,document[this.exitK]()},e.isFullscreen=function(){return document[this.elementK]}),e},O.toggleCaption=function(e){t(e)},O.resetCaptionCtrl=function(e){q(e)}}});